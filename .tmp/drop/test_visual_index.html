
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Power BI Custom Visual Test</title>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            font-family: Arial, sans-serif;
        }
        #container {
            width: 100%;
            height: 100%;
        }
    </style>
    <script src="https://unpkg.com/powerbi-visuals-api@2.6.0/lib/powerbi-visuals-api.js"></script>
</head>
<body>
    <div id="container"></div>

    <script src="https://localhost:8080/assets/visual.js"></script>
    <script>
        // Simulate Power BI host environment
        class MockHost {
            createSelectionIdBuilder() { return { withCategory: () => ({ build: () => ({}) }) }; }
            createSelectionManager() { return { select: () => {}, clear: () => {} }; }
        }

        // Define viewport
        const viewport = { width: window.innerWidth, height: window.innerHeight };

        // Simulate update options
        const updateOptions = {
            viewport,
            dataViews: [{
                metadata: {
                    objects: {
                        apiSettings: {
                            fontSize: 16,
                            debug: true,
                            openAiKey: "",
                            modelo: "gpt-4",
                            assistantId: "",
                            threadId: ""
                        }
                    }
                }
            }],
            type: 0, // ViewMode.View
            viewMode: 0,
            editMode: 0,
            operationKind: 0
        };

        // Initialize visual
        const visual = new powerbi.extensibility.visual.Visual({ element: document.getElementById("container"), host: new MockHost() });
        visual.update(updateOptions);
    </script>
</body>
</html>
