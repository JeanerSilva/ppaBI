{"visual":{"name":"Chat PPA","displayName":"Chat PPA","guid":"ChatPPA123456","visualClassName":"Visual","version":"1.0.0.0","description":"Chat PPA com ChatGPT","supportUrl":"https://openai.com","gitHubUrl":""},"author":{"name":"Ministério do Planejamento e Orçamento","email":"exemplo@openai.com"},"apiVersion":"5.3.0","style":"style/visual.less","stringResources":{},"capabilities":{"objects":{"apiSettings":{"displayName":"API Settings","properties":{"openAiKey":{"displayName":"OpenAI API Key","type":{"text":true}},"nome":{"displayName":"Modelo","type":{"text":true}},"systemPrompt":{"displayName":"System Prompt","type":{"text":true}}}}},"privileges":[{"name":"WebAccess"}]},"content":{"js":"var ChatPPA123456;(()=>{\"use strict\";var t={116:(t,e,s)=>{s.d(e,{P:()=>n});var o=s(271);class n{static getDefault(){return new this}static createPropertyIdentifier(t,e){return{objectName:t,propertyName:e}}static parse(t){const e=this.getDefault();if(!t||!t.metadata||!t.metadata.objects)return e;const s=e.getProperties();for(const n in s)for(const r in s[n]){const i=e[n][r];e[n][r]=o.Bl(t.metadata.objects,s[n][r],i)}return e}static isPropertyEnumerable(t){return!n.InnumerablePropertyPrefix.test(t)}static enumerateObjectInstances(t,e){const s=t&&t[e.objectName];if(!s)return[];const o={objectName:e.objectName,selector:null,properties:{}};for(const t in s)Object.prototype.hasOwnProperty.call(s,t)&&(o.properties[t]=s[t]);return{instances:[o]}}getProperties(){const t={};return Object.keys(this).forEach(e=>{if(n.isPropertyEnumerable(e)){const s=Object.keys(this[e]);t[e]={},s.forEach(s=>{n.isPropertyEnumerable(e)&&(t[e][s]=n.createPropertyIdentifier(e,s))})}}),t}}n.InnumerablePropertyPrefix=/^_/},271:(t,e,s)=>{s.d(e,{Bl:()=>n});var o=s(888);function n(t,e,s){const n=function(t,e,s){return t?o._(t[e.objectName],e.propertyName,s):s}(t,e,s);return n&&n.solid?n.solid.color:null==n||\"object\"==typeof n&&!n.solid?s:n}},473:(t,e,s)=>{s.d(e,{M:()=>n});var o=s(116).P;class n extends o{apiSettings=new r}class r{nome=\"gpt-4o\";openAiKey=\"\";systemPrompt=\"Você é um assistente útil no Power BI.\"}},848:(t,e,s)=>{s.d(e,{b:()=>n});var o=s(473);class n{container;output;settings;apiKey=\"\";systemPrompt=\"\";nome=\"gpt-4o\";constructor(t){this.container=document.createElement(\"div\"),this.container.style.padding=\"8px\",this.container.style.fontFamily=\"Segoe UI, sans-serif\",this.container.style.fontSize=\"13px\";const e=document.createElement(\"input\");e.type=\"text\",e.placeholder=\"Faça sua pergunta...\",e.style.width=\"300px\",e.style.marginRight=\"10px\",e.style.padding=\"4px\",e.style.border=\"1px solid #ccc\",e.style.borderRadius=\"3px\";const s=document.createElement(\"button\");s.innerText=\"Enviar\",s.style.backgroundColor=\"#666\",s.style.color=\"white\",s.style.border=\"none\",s.style.borderRadius=\"3px\",s.style.padding=\"5px 10px\",s.style.cursor=\"pointer\",this.output=document.createElement(\"div\"),this.output.style.marginTop=\"10px\",this.output.style.whiteSpace=\"pre-wrap\",this.output.style.border=\"1px solid #e0e0e0\",this.output.style.padding=\"10px\",this.output.style.borderRadius=\"3px\",this.output.style.backgroundColor=\"#fafafa\",this.output.style.color=\"#333\",s.onclick=()=>{const t=e.value.trim();t?this.apiKey?(this.output.innerText=\"Consultando ...\",fetch(\"https://api.openai.com/v1/chat/completions\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:`Bearer ${this.apiKey}`},body:JSON.stringify({model:this.nome,messages:[{role:\"system\",content:this.systemPrompt},{role:\"user\",content:t}]})}).then(t=>t.json()).then(t=>{const e=t.choices?.[0]?.message?.content;this.output.innerText=e||\"Resposta não encontrada.\"}).catch(t=>{console.error(t),this.output.innerText=\"Erro na consulta à API.\"})):this.output.innerText=\"Chave da API não configurada.\":this.output.innerText=\"Digite uma pergunta.\"},this.container.appendChild(e),this.container.appendChild(s),this.container.appendChild(this.output),t.element.appendChild(this.container)}update(t){this.settings=o.M.parse(t.dataViews?.[0]),this.apiKey=this.settings?.apiSettings?.openAiKey||\"\",this.systemPrompt=this.settings?.apiSettings?.systemPrompt||\"Você é um assistente útil no Power BI.\",this.nome=this.settings?.apiSettings?.nome||\"gpt-4o\"}enumerateObjectInstances(t){const e=this.settings||new o.M;return\"apiSettings\"===t.objectName?[{objectName:t.objectName,properties:{nome:e.apiSettings.nome,openAiKey:e.apiSettings.openAiKey,systemPrompt:e.apiSettings.systemPrompt},selector:null}]:[]}}},888:(t,e,s)=>{function o(t,e,s){if(!t)return s;const o=t[e];return void 0===o?s:o}s.d(e,{_:()=>o})}},e={};function s(o){var n=e[o];if(void 0!==n)return n.exports;var r=e[o]={exports:{}};return t[o](r,r.exports,s),r.exports}s.d=(t,e)=>{for(var o in e)s.o(e,o)&&!s.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.r=t=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})};var o={};(()=>{s.r(o),s.d(o,{default:()=>r});var t=s(848),e=window.powerbi,n={name:\"ChatPPA123456\",displayName:\"Chat PPA\",class:\"Visual\",apiVersion:\"5.3.0\",create:e=>{if(t.b)return new t.b(e);throw\"Visual instance not found\"},createModalDialog:(t,e,s)=>{const o=globalThis.dialogRegistry;t in o&&new o[t](e,s)},custom:!0};void 0!==e&&(e.visuals=e.visuals||{},e.visuals.plugins=e.visuals.plugins||{},e.visuals.plugins.ChatPPA123456=n);const r=n})(),ChatPPA123456=o})();","css":".root {\n  font-family: \"Segoe UI\", sans-serif;\n  font-size: 13px;\n  background-color: #f8f8f8;\n  color: #333;\n}\n\n","iconBase64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2RpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo3NEY1QjA1NUQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo3NEY1QjA1NEQ0OTAxMUUwQTgxREI2NjMxMkNEMUNEMyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IFdpbmRvd3MiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5Mjk5RDU1ODBGRDRFMDExQTcxQ0JFODI3ODBCQUE5RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpBOEJGMzkxN0NBRDNFMDExQTcxQ0JFODI3ODBCQUE5RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PpDoNX0AAAI3SURBVHjarJRLSFVRFIY9t7SiRDGLoEEPCRJRaCSYkxCiFCXCF+LIMExQLkilgumgwkbdBuWDRC2EomhURCOjgagkXEgKLUKhidobM6H0+i34rxyPnuvEA5/rXPda/1l7739vJxKJxG3ls93+hEKhTILxJhgMftmsiPxdhHw4CfepeR8dCyjWwwB0kZy3iVgCoQ2ewnmXxhrBD7Cgr/ZQVA17fDRPw2UYhzK6G99IsBse6/0QNME+H8FT4EA/YiPqOgA1q4IMzBNuw6iKjkCpj+Av+AdnEEmD3bxfhzvuDk30HaEaLsEkXCO53rN+Bwg5qsvTuj/TjGYtx9nINhRmEx7AYWiFW7AXOuEcbPOUvIZ2mnrl+PkQUbNEh4QHNKUSDdsSBWEOlmxTEfvs26FL9Khe211if6Acgee+xo7xzMgBxfq9qPe3fgWBGN2lEnqtG9nExM7CV3jp3bDos2bKJB0nHFRxAxRpA/5CIXyHh5ABv6GZqd9dJ6iz2SjbxMMypGhJFtTlNzu3kK7xgDxpove8U66FK2A+s6nul5gVVMEL+Ak7lG/T+g9JcIOGar2CRUoogxMwpP/bLTJMB9bRhDbkk5bBUU0y3ES0xS04CBfN9RSHiY90vJK0BHaSzG9h2eejS3RJeVfdtrGzuGyd8CX7Yq6ExuCH63jaVMPkFOv6OibB6DKs2+VEQp+WYBoqERn2sVWWRNN0YurIfeL14U6YkpkLYCSG6e0yqdCxvKBLIm5FgAEAV0nKuwMYRUsAAAAASUVORK5CYII="},"visualEntryPoint":""}